--between,in,and,or
select * from emp;
--급여가 1200~2000사이의 이름,급여,보너스를 구하시오(and)
select ename,sal,comm from emp where sal>=1200 and sal<=2000;
--급여가 1200~2000사이의 이름,급여,보너스를 구하시오(between)
select ename,sal,comm from emp where sal between 1200 and 2000;
--job이 MANAGER,SALESMAN인 사람의 이름과 직업을 구하시오(or)
select ename,job from emp where job='MANAGER' or job='SALESMAN';
--job이 MANAGER,SALESMAN인 사람의 이름과 직업을 구하시오(in)
select ename , job from emp where job in ('MANAGER','SALESMAN');

--UNION 두 결과값에서 중복된값 제거후 출력
--UNION ALL 중복값까지 출력
select name from student where deptno1=101 union select name from student where deptno2=201;
select name from student where deptno1=101 union ALL select name from student where deptno2=201;

--교집합 INTERSECT
select name from student where deptno1=101 INTERSECT select name from student where deptno2=201; 

--단일함수
--Count
--count(*)는 Null값 포함, count(hpage)는 Null값 제외
select count(*),count(hpage) from professor;

--sum
select count(bonus),sum(bonus) from professor;

--avg
select count(bonus),sum(bonus),avg(bonus) from professor;

--max,min
select max(sal),min(sal) from emp;
select max(hiredate),min(hiredate) from emp;

--그룹함수
--emp의 전체 갯수
select count(*) from emp;
--급여의 평균
select avg(sal) from emp;
--소수점 자릿수)
select round(avg(sal),2) from emp; --소수점 2자리
select round(avg(sal),1) from emp; --소수점 1자리
select round(avg(sal),0) from emp; --소수점 없이 반올림

select round(avg(sal),-1) from emp; --1의자리 반올림(절삭처리)
select round(avg(sal),-2) from emp; --10의자리 반올림(절삭처리)

--To_CHAR ..date형 Number형을 varchar2로 바꿔준다
--현재날짜를 콘솔에 출력 sysdate
select sysdate from dual;

--내일날짜를 콘솔에 출력 sysdate
select sysdate+1 from dual;

--일주일뒤날짜를 콘솔에 출력 sysdate
select sysdate+7 from dual;

--날짜에서 월만 추출 3월 ..대소문자 같다
select to_char(sysdate,'MONTH') from dual;

--날짜에서 월만 추출 3월 ..대소문자 같다
select to_char(sysdate,'mm') from dual;

--날짜와 시간 출력
alter session set time_zone='Asia/Seoul';
select to_char(sysdate,'yyyy-mm-dd hh-mi-ss') from dual;
select to_char(current_timestamp,'yyyy-mm-dd hh-mi-ss') from dual;

--to_char number형 숫자에도 적용가능
select to_char(457836546,'999,999,999')from dual;
select to_char(54.9,'99999.00')from dual; --9는 값이 없으면 공백으로나온다

--오전복습문제
select * from emp;
select * from professor;
select * from gogak;
select * from student;
--1.emp-표현식을 이용하여 SMITH(CLERK)로 조회하시오
select ename,job from emp where ename='SMITH' and job='CLERK';

--2.professor- 이름,급여,보너스,총급여 로 조회하시오
select name"이름",pay"급여",NVL(bonus,0)"보너스", pay*12"총급여" from professor;

--3.gogak- 고객테이블에서 포인트가 50만 이상인 사람의 이름 주민번호 포인트 조회하시오
select gname,jumin,point from gogak where point>=500000;

--4.student-학생테이블에서 서진수의 학년 전화번호 출력하시오
select grade,tel from student where name='서진수';

--5.gogak-고객테이블에서 포인트가 30만~50만 사이인 사람의 이름과 포인트를 출력하고 포인트가 높은순으로 조회하시오
select gname, point from gogak where point between 300000 and 500000 order by point desc;

--6.student- 성이 김씨이거나 이씨인학생의 학번,학생명,학년을 조회하시오
select studno,name,grade 
from student 
where name like '김%' 
or name like '이%';

--7.student- 4학년중에서 키가 170보다 작거나 몸무게가 60보다 많은 학생의 이름,학년,키 몸무게를 조회하시오
select name,grade,height,weight 
from student 
where grade=4 
and height<=170 
or weight>=60;

--8.emp-직업이 MANAGER인 사람의 이름 보너스를 구하되 널값은 0으로 바꾸시오
select ename 이름, NVL(comm,0) "보너스" 
from emp 
where job='MANAGER';

--9.emp-이름,급여,연봉(급여*12),보너스,총연봉(연봉+보너스)로 출력하되 직업의 오름차순 연봉의 내림차순으로 조회할것
select ename 이름,job 직업, sal 급여, sal*12 연봉, NVL(comm,0)보너스,(sal*12)+NVL(comm,0) 총연봉 
from emp
order by job,sal desc;

--10.student- 3학년이름과 키를 출력 단 이름 오름차순
select name 이름, height 키 
from student 
where grade=3 
order by height;

--11.emp-입사일이 5월인 사람만 사원명,입사일 출력하시오
select ename 사원명,hiredate 입사일 
from emp 
where to_char(hiredate,'mm')='05';

--12.student- 이름에 '미'를 포함하고 있는 사람의 학생명,학년을 조회하시오
select name,grade 
from student 
where name Like '%미%';

--emp- 사원명중에 대소문자 관계없이 'N'을 포함하고 있는 데이터 출력(사원명,직업,급여)
select ename,job,sal 
from emp 
where lower(ename) Like '%n%';
