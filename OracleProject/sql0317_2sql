--Rollup 함수
--자동으로 소계/합계를 구해주는 함수
--Group by 절에 주어진 조건을 소계구해준다
select *from professor;
select deptno,position ,sum(pay) from professor group by position ,rollup(deptno);

select position, count(*), sum(pay) from professor group by rollup(position);

--cube 전체 총합계까지 출려하려면 rollup처럼 각 소계에 총계까지 구해준다
select deptno,count(*),sum(pay) from professor group by cube(deptno);
select * from emp;
--emp에서 직업별 인원수 최대급여 최소급여 구하세요
select job 직업, count(*)인원수, max(sal)"최대 급여", min(sal)"최소 급여" from emp group by job;

--emp에서 부서별 부서번호,인원수,급여평균,급여의 합 조회
select deptno, count(*)"인원수", round(avg(sal),2)"평균 급여", round(sum(sal),2) "급여의 합" from emp group by deptno;

--입사년도별 인원수,sal의 평균(소수점없이) 출력하되 입사년도의 오름차순
select to_char(hiredate,'yyyy') 입사년도별, count(*) 인원수,round(avg(sal),0) 평균급여 
from emp 
group by to_char(hiredate,'yyyy') 
order by to_char(hiredate,'yyyy'); 
 
--102-유아교육과 200 103-미술교육과 201-영문학과 202-국문학과

insert into department (deptno,dname) values(102,'유아교육과');
insert into department (deptno,dname) values(103,'미술교육과');
insert into department (deptno,dname) values(201,'영문학과');
insert into department (deptno,dname) values(202,'국문학과');

delete from department where deptno=10 or deptno=20;

select *from department order by deptno;

--professor에 데이터 입력
select *from professor;
insert into professor(profno,name,id,position,pay,hiredate,deptno) 
values(5001,'손흥민','loveme','정교수',500,sysdate,301);

update professor set bonus=100 where position='조교수';

--손흥민교수와 동일한 직급을 가진 교수들중 500이 안되는 교수들의 급여를 15%인상하세요
update professor set pay=pay*1.15 
where position=(select position 
                from professor 
                where name='손흥민') 
                and pay<500;

commit;
--dept2에서 부서번호 1001~1009 사이의 매장들을 모두 삭제해주세요
delete from dept2 where dcode between 1001 and 1009;

--alter 테이블의 구조변경
--dept2를 복제하여 dept3를 만들어 주세요
create table dept3 as select * from dept2;

--dept3에 loc를 추가하고 기본값으로 대한민국이라고 넣을것
alter table dept3 add loc varchar2(20) default'대한민국';

--포항본사 loc를 포항시청앞 으로 수정해주세요
update dept3 set loc='포항시청앞' where area='포항본사';

update dept3 set loc='광화문' where area='서울지사';

update dept3 set loc='울산시청앞' where area='울산지사';




--create , insert delete, update, select

--emp 테이블에 TotSal 열을 하나 더 추가해 주세요 number(20)
alter table emp add TotSal number(20);

--sal+comm을 더해서 데이터를 추가해 주세요
update emp set TotSal=sal+NVL(comm,0);
select *from emp;


select * from dept3;

--과제테이블 만들기-----------------------------------------------

--1. sequence : seqshop(1부터 2씩증가 캐쉬없음)
create sequence seqshop increment by 2 nocache;

--2. 테이블: myshop
--no number(5) 기본키 (시퀀스)
--sangpum varchar2(30),
--su number(10)
--price number(10)
--size varchar2(30)
--ipgoday date (오늘날짜)
create table myshop(no number(5) primary key, sangpum varchar(30), su number(10), price number(10), size_ varchar2(30), ipgoday date);

desc myshop;
--최소 5개이상 insert 해볼것!!

insert into myshop values(seqshop.nextval ,'반팔',50,10000,'L',sysdate);
insert into myshop values(seqshop.nextval ,'자켓',80,30000,'XL',sysdate);
insert into myshop values(seqshop.nextval ,'청바지',100,15000,'L',sysdate);
insert into myshop values(seqshop.nextval ,'신발',60,25000,'M',sysdate);
insert into myshop values(seqshop.nextval ,'후드티',100,20000,'L',sysdate);
insert into myshop values(seqshop.nextval ,'가방',30,35000,'L',sysdate);

select *from myshop;

alter table myshop modify Tot varchar2(20);
update myshop set tot=to_char(su*price,'999,999,999');

commit;










