package day0324;

import java.awt.Color;
import java.awt.Container;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.Vector;

import javax.swing.JButton;
import javax.swing.JComboBox;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JOptionPane;
import javax.swing.JTextField;
import javax.swing.table.DefaultTableModel;

import day0319.DbConnect;

public class Ex00UpdataScore extends JFrame implements ActionListener {

	Container cp;
	JTextField tfName, tfJava, tfJsp, tfSpring;
	JComboBox<String> cbBan;
	JButton btnUpdate; //입력한 점수를 메인에 추가하는 버튼
	DbConnect db=new DbConnect();
	String num;
	//생성자
	public Ex00UpdataScore(String title) {
		super(title);
		
		//위치,너비
		this.setBounds(1000, 100, 600, 350);		
		cp=this.getContentPane();
		//메인프레임 종료
       // this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
		//창 색상
		cp.setBackground(new Color(245,245,245));		
		initDesign();
		
		//this.setVisible(true);	
	}
	
	public void selectData(String num)
	{
		
		Connection conn=db.getConnection();
		PreparedStatement pstmt=null;
		ResultSet rs=null;
		
		String sql="select name, ban, java, jsp, spring from stuscore where num=?";
		
		try {
			pstmt=conn.prepareStatement(sql);
			pstmt.setString(1, num);
			
			//int a=pstmt.executeUpdate();			
			rs=pstmt.executeQuery();
			
			
			
			
			if(rs.next())
			{				
				JLabel lblName1=new JLabel(rs.getString("name"));;				
				JLabel lblBan1=new JLabel(rs.getString("ban"));
				JLabel lblJava1=new JLabel(rs.getString("java"));
				JLabel lblJsp1=new JLabel(rs.getString("jsp"));
				JLabel lblSpring1=new JLabel(rs.getString("spring"));			
			
				lblName1.setBounds(120, 40, 60, 30);
				this.add(lblName1);
				lblBan1.setBounds(120, 70, 60, 30);
				this.add(lblBan1);
				lblJava1.setBounds(120, 110, 60, 30);
				this.add(lblJava1);
				lblJsp1.setBounds(120, 150, 60, 30);
				this.add(lblJsp1);
				lblSpring1.setBounds(120, 190, 60, 30);
				this.add(lblSpring1);		
								
			}
			else
				JOptionPane.showMessageDialog(this, "수정할 행이 없습니다");
					
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}finally {
			db.dbClose(rs, pstmt, conn);
		}
	}
	
	public void initDesign()
	{
		this.setLayout(null);
		JLabel title1=new JLabel("수정할 학생 정보");
		JLabel title2=new JLabel("학생명");
		JLabel title3=new JLabel("반");
		JLabel title4=new JLabel("Java");
		JLabel title5=new JLabel("Jsp");
		JLabel title6=new JLabel("Spring");
		
		
		
		title1.setBounds(20, 10, 90, 30);
		this.add(title1);		
		title2.setBounds(20, 40, 60, 30);
		this.add(title2);
		title3.setBounds(20, 70, 60, 30);
		this.add(title3);
		title4.setBounds(20, 110, 60, 30);
		this.add(title4);
		title5.setBounds(20, 150, 60, 30);
		this.add(title5);
		title6.setBounds(20, 190, 60, 30);
		this.add(title6);
		
		
		
		
		tfName=new JTextField();
		String [] ban= {"1강의장","2강의장","3강의장","4강의장"};
		cbBan=new JComboBox<String>(ban);
		tfJava=new JTextField();		
		tfJsp=new JTextField();
		tfSpring=new JTextField();
		
		JLabel lblName=new JLabel("==>");
		JLabel lblBan=new JLabel("==>");
		JLabel lblJava=new JLabel("==>");
		JLabel lblJsp=new JLabel("==>");
		JLabel lblSpring=new JLabel("==>");		
		
		lblName.setBounds(200, 40, 60, 30);
		this.add(lblName);
		lblBan.setBounds(200, 70, 60, 30);
		this.add(lblBan);
		lblJava.setBounds(200, 110, 60, 30);
		this.add(lblJava);
		lblJsp.setBounds(200, 150, 60, 30);
		this.add(lblJsp);
		lblSpring.setBounds(200, 190, 60, 30);
		this.add(lblSpring);
		
		tfName.setBounds(290, 45, 70, 20);		
		this.add(tfName);		
		cbBan.setBounds(290, 80, 70, 20);
		this.add(cbBan);		
		tfJava.setBounds(290, 120, 70, 20);
		this.add(tfJava);		
		tfJsp.setBounds(290, 160, 70, 20);
		this.add(tfJsp);		
		tfSpring.setBounds(290, 200, 70, 20);
		this.add(tfSpring);		
		
		//버튼
		btnUpdate=new JButton("점수수정");
		btnUpdate.setBounds(50, 240, 90, 30);
		btnUpdate.addActionListener(this);
		this.add(btnUpdate);
		
		
		
	}
	
	public static void main(String[] args) {
		//new UpdateScore("성적 수정 폼");
	}

	public void actionPerformed(ActionEvent e, String num) {
		// TODO Auto-generated method stub
		Object ob=e.getSource();
		
		Connection conn=db.getConnection();
		PreparedStatement pstmt=null;
		
		String sql="update stuscore set name, java, spring, ban where num=?";
		
		if(ob==btnUpdate)
		{
			try {
			pstmt=conn.prepareStatement(sql);
			pstmt.setString(1, num);			
			pstmt.execute();			
			
			
		} catch (SQLException e1) {
			// TODO Auto-generated catch block
			e1.printStackTrace();
		}finally {
			db.dbClose(pstmt, conn);
		}		
			this.dispose();
		}
		
	}

	@Override
	public void actionPerformed(ActionEvent e) {
		// TODO Auto-generated method stub
		
	}
}
